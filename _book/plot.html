<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Base and grid plots | Spatial Data Science</title>
  <meta name="description" content="description_xx" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Base and grid plots | Spatial Data Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="description_xx" />
  <meta name="github-repo" content="edzer/sdsr" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Base and grid plots | Spatial Data Science" />
  
  <meta name="twitter:description" content="description_xx" />
  

<meta name="author" content="Edzer Pebesma, Roger Bivand" />


<meta name="date" content="2020-10-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="plotting.html"/>
<link rel="next" href="ggplot2.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>
<script src="libs/FlatGeoBuf-3.3.3/fgb.js"></script>
<script src="libs/FlatGeoBuf-3.3.3/flatgeobuf-geojson.min.js"></script>
<script src="libs/chromajs-2.1.0/chroma.min.js"></script>
<link id="_-BIR74-1-attachment" rel="attachment" href="libs/_-BIR74-0.0.1/_-BIR74_layer.fgb"/>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Spatial Data Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Spatial Data</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Getting Started</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#a-first-map"><i class="fa fa-check"></i><b>1.1</b> A first map</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#coordinate-reference-systems"><i class="fa fa-check"></i><b>1.2</b> Coordinate reference systems</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#raster-and-vector-data"><i class="fa fa-check"></i><b>1.3</b> Raster and vector data</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#raster-types"><i class="fa fa-check"></i><b>1.4</b> Raster types</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#time-series-arrays-data-cubes"><i class="fa fa-check"></i><b>1.5</b> Time series, arrays, data cubes</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#support"><i class="fa fa-check"></i><b>1.6</b> Support</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#spatial-data-science-software"><i class="fa fa-check"></i><b>1.7</b> Spatial data science software</a></li>
<li class="chapter" data-level="1.8" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>1.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cs.html"><a href="cs.html"><i class="fa fa-check"></i><b>2</b> Coordinate systems</a><ul>
<li class="chapter" data-level="2.1" data-path="cs.html"><a href="cs.html#polar-and-cartesian-coordinates"><i class="fa fa-check"></i><b>2.1</b> Polar and Cartesian coordinates</a></li>
<li class="chapter" data-level="2.2" data-path="cs.html"><a href="cs.html#ellipsoidal-coordinates"><i class="fa fa-check"></i><b>2.2</b> Ellipsoidal coordinates</a></li>
<li class="chapter" data-level="2.3" data-path="cs.html"><a href="cs.html#projected-coordinates"><i class="fa fa-check"></i><b>2.3</b> Projected coordinates</a></li>
<li class="chapter" data-level="2.4" data-path="cs.html"><a href="cs.html#distances"><i class="fa fa-check"></i><b>2.4</b> Distances</a></li>
<li class="chapter" data-level="2.5" data-path="cs.html"><a href="cs.html#bounded"><i class="fa fa-check"></i><b>2.5</b> Bounded and unbounded spaces</a></li>
<li class="chapter" data-level="2.6" data-path="cs.html"><a href="cs.html#time"><i class="fa fa-check"></i><b>2.6</b> Time</a></li>
<li class="chapter" data-level="2.7" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>2.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="geometries.html"><a href="geometries.html"><i class="fa fa-check"></i><b>3</b> Geometries</a><ul>
<li class="chapter" data-level="3.1" data-path="geometries.html"><a href="geometries.html#simple-feature-geometries"><i class="fa fa-check"></i><b>3.1</b> Simple feature geometries</a></li>
<li class="chapter" data-level="3.2" data-path="geometries.html"><a href="geometries.html#opgeom"><i class="fa fa-check"></i><b>3.2</b> Operations on geometries</a></li>
<li class="chapter" data-level="3.3" data-path="geometries.html"><a href="geometries.html#precision"><i class="fa fa-check"></i><b>3.3</b> Precision</a></li>
<li class="chapter" data-level="3.4" data-path="geometries.html"><a href="geometries.html#geomraster"><i class="fa fa-check"></i><b>3.4</b> Coverages: tesselations and rasters</a></li>
<li class="chapter" data-level="3.5" data-path="geometries.html"><a href="geometries.html#networks"><i class="fa fa-check"></i><b>3.5</b> Networks</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spherical.html"><a href="spherical.html"><i class="fa fa-check"></i><b>4</b> Spherical Geometries</a><ul>
<li class="chapter" data-level="4.1" data-path="spherical.html"><a href="spherical.html#straight-lines"><i class="fa fa-check"></i><b>4.1</b> Straight lines</a></li>
<li class="chapter" data-level="4.2" data-path="spherical.html"><a href="spherical.html#ring-direction"><i class="fa fa-check"></i><b>4.2</b> Ring direction</a></li>
<li class="chapter" data-level="4.3" data-path="spherical.html"><a href="spherical.html#full-polygon"><i class="fa fa-check"></i><b>4.3</b> Full polygon</a></li>
<li class="chapter" data-level="4.4" data-path="spherical.html"><a href="spherical.html#bounding-box-rectangle-and-cap"><i class="fa fa-check"></i><b>4.4</b> Bounding box, rectangle, and cap</a></li>
<li class="chapter" data-level="4.5" data-path="spherical.html"><a href="spherical.html#validity-on-the-sphere"><i class="fa fa-check"></i><b>4.5</b> Validity on the sphere</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="featureattributes.html"><a href="featureattributes.html"><i class="fa fa-check"></i><b>5</b> Attributes, Up- and Downscaling</a><ul>
<li class="chapter" data-level="5.1" data-path="featureattributes.html"><a href="featureattributes.html#agr"><i class="fa fa-check"></i><b>5.1</b> Attribute-geometry relationships</a></li>
<li class="chapter" data-level="5.2" data-path="featureattributes.html"><a href="featureattributes.html#spatial-join"><i class="fa fa-check"></i><b>5.2</b> Spatial join</a></li>
<li class="chapter" data-level="5.3" data-path="featureattributes.html"><a href="featureattributes.html#aggregating-and-summarising"><i class="fa fa-check"></i><b>5.3</b> Aggregating and Summarising</a></li>
<li class="chapter" data-level="5.4" data-path="featureattributes.html"><a href="featureattributes.html#area-weighted-interpolation"><i class="fa fa-check"></i><b>5.4</b> Area-weighted interpolation</a></li>
<li class="chapter" data-level="5.5" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="raster.html"><a href="raster.html"><i class="fa fa-check"></i><b>6</b> Raster and vector datacubes</a><ul>
<li class="chapter" data-level="6.1" data-path="raster.html"><a href="raster.html#package-stars"><i class="fa fa-check"></i><b>6.1</b> Package <code>stars</code></a></li>
<li class="chapter" data-level="6.2" data-path="raster.html"><a href="raster.html#raster-data"><i class="fa fa-check"></i><b>6.2</b> Raster data</a></li>
<li class="chapter" data-level="6.3" data-path="raster.html"><a href="raster.html#datacubes"><i class="fa fa-check"></i><b>6.3</b> Vector Datacubes</a></li>
<li class="chapter" data-level="6.4" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>6.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="updownscaling.html"><a href="updownscaling.html"><i class="fa fa-check"></i><b>7</b> Up- and Downscaling</a></li>
<li class="chapter" data-level="8" data-path="rs.html"><a href="rs.html"><i class="fa fa-check"></i><b>8</b> Reference Systems</a><ul>
<li class="chapter" data-level="8.1" data-path="rs.html"><a href="rs.html#units"><i class="fa fa-check"></i><b>8.1</b> Units of measurement</a></li>
<li class="chapter" data-level="8.2" data-path="rs.html"><a href="rs.html#temporal-reference-systems"><i class="fa fa-check"></i><b>8.2</b> Temporal Reference Systems</a></li>
<li class="chapter" data-level="8.3" data-path="rs.html"><a href="rs.html#crs"><i class="fa fa-check"></i><b>8.3</b> Coordinate Reference Systems</a></li>
</ul></li>
<li class="part"><span><b>II R for Spatial Data Science</b></span></li>
<li class="chapter" data-level="9" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>9</b> Plotting spatial data</a><ul>
<li class="chapter" data-level="9.1" data-path="plotting.html"><a href="plotting.html#transform"><i class="fa fa-check"></i><b>9.1</b> Every plot is a projection</a></li>
<li class="chapter" data-level="9.2" data-path="plotting.html"><a href="plotting.html#plotting-points-lines-polygons-grid-cells"><i class="fa fa-check"></i><b>9.2</b> Plotting points, lines, polygons, grid cells</a></li>
<li class="chapter" data-level="9.3" data-path="plotting.html"><a href="plotting.html#classintervals"><i class="fa fa-check"></i><b>9.3</b> Color palettes and class intervals</a></li>
<li class="chapter" data-level="9.4" data-path="plotting.html"><a href="plotting.html#poles-and-datelines"><i class="fa fa-check"></i><b>9.4</b> Poles and datelines</a></li>
<li class="chapter" data-level="9.5" data-path="plotting.html"><a href="plotting.html#graticule"><i class="fa fa-check"></i><b>9.5</b> Graticules and other navigation aids</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="plot.html"><a href="plot.html"><i class="fa fa-check"></i><b>10</b> Base and grid plots</a><ul>
<li class="chapter" data-level="10.1" data-path="plot.html"><a href="plot.html#base-plots"><i class="fa fa-check"></i><b>10.1</b> Base plots</a></li>
<li class="chapter" data-level="10.2" data-path="plot.html"><a href="plot.html#combining-base-plots"><i class="fa fa-check"></i><b>10.2</b> Combining base plots</a></li>
<li class="chapter" data-level="10.3" data-path="plot.html"><a href="plot.html#grid-plots-and-viewports"><i class="fa fa-check"></i><b>10.3</b> Grid plots and viewports</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>11</b> ggplot2</a><ul>
<li class="chapter" data-level="11.1" data-path="ggplot2.html"><a href="ggplot2.html#geom_sf"><i class="fa fa-check"></i><b>11.1</b> <code>geom_sf</code></a></li>
<li class="chapter" data-level="11.2" data-path="ggplot2.html"><a href="ggplot2.html#geom_stars"><i class="fa fa-check"></i><b>11.2</b> <code>geom_stars</code></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="interactive.html"><a href="interactive.html"><i class="fa fa-check"></i><b>12</b> Interactive Maps</a></li>
<li class="part"><span><b>III Models for Spatial Data</b></span></li>
<li class="chapter" data-level="13" data-path="pointpatterns.html"><a href="pointpatterns.html"><i class="fa fa-check"></i><b>13</b> Point Pattern Analysis</a></li>
<li class="chapter" data-level="14" data-path="manipulating-attributes-summarise-aggregate-union-sample.html"><a href="manipulating-attributes-summarise-aggregate-union-sample.html"><i class="fa fa-check"></i><b>14</b> Manipulating attributes: summarise, aggregate, union, sample</a></li>
<li class="chapter" data-level="15" data-path="area-data-and-spatial-autocorrelation.html"><a href="area-data-and-spatial-autocorrelation.html"><i class="fa fa-check"></i><b>15</b> Area Data and Spatial Autocorrelation</a><ul>
<li class="chapter" data-level="15.1" data-path="area-data-and-spatial-autocorrelation.html"><a href="area-data-and-spatial-autocorrelation.html#spatial-autocorrelation"><i class="fa fa-check"></i><b>15.1</b> Spatial autocorrelation</a></li>
<li class="chapter" data-level="15.2" data-path="area-data-and-spatial-autocorrelation.html"><a href="area-data-and-spatial-autocorrelation.html#spatial-weight-matrices"><i class="fa fa-check"></i><b>15.2</b> Spatial weight matrices</a></li>
<li class="chapter" data-level="15.3" data-path="area-data-and-spatial-autocorrelation.html"><a href="area-data-and-spatial-autocorrelation.html#measures-of-spatial-autocorrelation"><i class="fa fa-check"></i><b>15.3</b> Measures of spatial autocorrelation</a></li>
<li class="chapter" data-level="15.4" data-path="area-data-and-spatial-autocorrelation.html"><a href="area-data-and-spatial-autocorrelation.html#spatial-heterogeneity"><i class="fa fa-check"></i><b>15.4</b> Spatial heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="spatial-regression.html"><a href="spatial-regression.html"><i class="fa fa-check"></i><b>16</b> Spatial Regression</a><ul>
<li class="chapter" data-level="16.1" data-path="spatial-regression.html"><a href="spatial-regression.html#spatial-regression-with-spatial-weights"><i class="fa fa-check"></i><b>16.1</b> Spatial regression with spatial weights</a></li>
<li class="chapter" data-level="16.2" data-path="spatial-regression.html"><a href="spatial-regression.html#estimators"><i class="fa fa-check"></i><b>16.2</b> Estimators</a></li>
<li class="chapter" data-level="16.3" data-path="spatial-regression.html"><a href="spatial-regression.html#implementation-details"><i class="fa fa-check"></i><b>16.3</b> Implementation details</a></li>
<li class="chapter" data-level="16.4" data-path="spatial-regression.html"><a href="spatial-regression.html#markov-random-field-and-multilevel-models-with-spatial-weights"><i class="fa fa-check"></i><b>16.4</b> Markov random field and multilevel models with spatial weights</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="movement-data.html"><a href="movement-data.html"><i class="fa fa-check"></i><b>17</b> Movement data</a></li>
<li class="chapter" data-level="18" data-path="statistical-modelling-of-spatiotemporal-data.html"><a href="statistical-modelling-of-spatiotemporal-data.html"><i class="fa fa-check"></i><b>18</b> Statistical modelling of spatiotemporal data</a></li>
<li class="chapter" data-level="19" data-path="sp-and-raster.html"><a href="sp-and-raster.html"><i class="fa fa-check"></i><b>19</b> sp and raster</a><ul>
<li class="chapter" data-level="19.1" data-path="sp-and-raster.html"><a href="sp-and-raster.html#links-and-differences-between-sf-and-sp"><i class="fa fa-check"></i><b>19.1</b> links and differences between sf and sp</a></li>
<li class="chapter" data-level="19.2" data-path="sp-and-raster.html"><a href="sp-and-raster.html#migration-packages"><i class="fa fa-check"></i><b>19.2</b> migration packages</a></li>
<li class="chapter" data-level="19.3" data-path="sp-and-raster.html"><a href="sp-and-raster.html#raster-stars-and-sf"><i class="fa fa-check"></i><b>19.3</b> raster, stars and sf</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i>R basics</a><ul>
<li class="chapter" data-level="19.4" data-path="r-basics.html"><a href="r-basics.html#pipes"><i class="fa fa-check"></i><b>19.4</b> Pipes</a></li>
<li class="chapter" data-level="19.5" data-path="r-basics.html"><a href="r-basics.html#data-structures"><i class="fa fa-check"></i><b>19.5</b> Data structures</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plot" class="section level1">
<h1><span class="header-section-number">Chapter 10</span> Base and grid plots</h1>
<p>With base plots we mean the <code>plot</code> methods as offered by base R.
Higher-level plots created with <code>ggplot2</code>, which are built on top
of the <code>grid</code> package, are discussed in chapter <a href="ggplot2.html#ggplot2">11</a>.</p>
<div id="base-plots" class="section level2">
<h2><span class="header-section-number">10.1</span> Base plots</h2>
<p>The nice thing about base plots is that they work relatively simply,
and can be built incrementally: after plotting a first element, it
is possible to add further elements — like titles, axes, legends,
annotations — with additional function calls. Making more complex plots such as faceted
plots is more of a challenge with base plot. They may also be
faster than e.g. <code>ggplot2</code>. This chapter focuses on the base <code>plot</code>
methods for <code>sf</code> and <code>stars</code> objects, and in particular where they
deviate from what one expects from <code>base</code> R plots: default colors,
color key placement, and multiple maps.</p>
<div id="plot.sf-defaults" class="section level3">
<h3><span class="header-section-number">10.1.1</span> <code>plot.sf</code> defaults</h3>
<p>When we plot an <code>sf</code> object with multiple attributes, we get to see
multiple attributes, as shown in figure <a href="plot.html#fig:plotsf">10.1</a>; the warning indicates that
the number of attributes plotted has been limited (by the argument <code>max.plot</code>),
that by default no key is shown when multiple attributes are plotted,
and that <code>factor</code> or <code>character</code> columns are plotted with a categorical
scale, and <code>numeric</code> variables by a continuous color scale.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" title="1"><span class="kw">system.file</span>(<span class="st">&quot;gpkg/nc.gpkg&quot;</span>, <span class="dt">package=</span><span class="st">&quot;sf&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>read_sf -&gt;<span class="st"> </span>nc</a>
<a class="sourceLine" id="cb142-2" title="2"><span class="kw">plot</span>(nc)</a>
<a class="sourceLine" id="cb142-3" title="3"><span class="co"># Warning: plotting the first 10 out of 14 attributes; use max.plot = 14 to plot</span></a>
<a class="sourceLine" id="cb142-4" title="4"><span class="co"># all</span></a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plotsf"></span>
<img src="sds_files/figure-html/plotsf-1.png" alt="default plot with multiple attributes" width="100%" />
<p class="caption">
Figure 10.1: default plot with multiple attributes
</p>
</div>
<p>When the attributes values have a common reference system it makes sense
to plot a key, and this can be done by</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(dplyr))</a>
<a class="sourceLine" id="cb143-2" title="2">nc <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(SID74, SID79) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">plot</span>(<span class="dt">key.pos =</span> <span class="dv">4</span>) <span class="co"># 1: below; 4: right</span></a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plotkey"></span>
<img src="sds_files/figure-html/plotkey-1.png" alt="two attributes sharing a key" width="60%" />
<p class="caption">
Figure 10.2: two attributes sharing a key
</p>
</div>
</div>
<div id="controlling-color-color-breaks-key" class="section level3">
<h3><span class="header-section-number">10.1.2</span> Controlling color, color breaks, key</h3>
<p>The color of each feature geometry, be it a point, line or polygon,
can be controlled by passing a single value to argument <code>col</code>, or to
pass a vector with colors of length equal to the number of features.
In that case, one does not get an automatic key, since the mapping
of values to the key is unclear.</p>
<p>One can get further control over the key by specifying either of</p>
<ul>
<li><code>breaks</code>, to one of the <code>classInt::classIntervals</code> styles (“fixed”,
“sd”, “equal”, “pretty”, “quantile”, “kmeans”, “hclust”, “bclust”,
“fisher”, or “jenks”), or to the numeric vector of (increasing)
class break values,</li>
<li><code>nbreaks</code> to set the number of color breaks, and</li>
<li><code>pal</code>, to pass a <em>function</em> that generates a palette, e.g. <code>rainbow</code>
or <code>viridis::viridis</code>.</li>
<li><code>logz</code> which causes legend values to be plotted as 10-powers</li>
<li><code>at</code> which controls the values plotted along the key</li>
<li><code>key.pos</code> plots the key beneath (1), left (2), over (3) or to the
right (4) of the map(s), and is omitted if <code>NULL</code>.</li>
</ul>
<p>An example is shown in figure <a href="plot.html#fig:viridis">10.3</a>.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" title="1"><span class="kw">plot</span>(nc[<span class="st">&quot;SID74&quot;</span>], <span class="dt">logz =</span> <span class="ot">TRUE</span>, <span class="dt">pal =</span> viridis<span class="op">::</span>viridis,</a>
<a class="sourceLine" id="cb144-2" title="2">    <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,.<span class="dv">5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>,<span class="fl">2.5</span>), <span class="dt">at =</span> <span class="kw">c</span>(<span class="dv">0</span>,.<span class="dv">5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>,<span class="fl">2.5</span>),</a>
<a class="sourceLine" id="cb144-3" title="3">    <span class="dt">key.width =</span> <span class="kw">lcm</span>(<span class="fl">1.3</span>), <span class="dt">key.length =</span> <span class="dv">1</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:viridis"></span>
<img src="sds_files/figure-html/viridis-1.png" alt="controlling key color and breaks; log transform causes zero values to remain uncolored; custom key size parameters" width="60%" />
<p class="caption">
Figure 10.3: controlling key color and breaks; log transform causes zero values to remain uncolored; custom key size parameters
</p>
</div>
<p>For factor variables, the key shows factor levels, and <code>key.length</code>
and/or <code>key.width</code> may need to be further controlled to get them
look good.</p>
</div>
<div id="reset" class="section level3">
<h3><span class="header-section-number">10.1.3</span> Incrementally adding plot elements</h3>
<p>We can add elements to maps without keys by simply adding <code>add = TRUE</code>. When a map has a key, the initial <code>plot</code> command needs
to have <code>reset = FALSE</code>.</p>
<p>The reason for this is as follows.
When plotting a map with a key on the side, in base plot one needs
to cut up the plotting region in a region for the map, and a region
for the key, similar to using <code>par(mfrow = c(1,2))</code>.
In order to not keep the plot region splitting active for subsequent,
unrelated plots, it is removed before the plot function returns. This
means that <em>by default</em> one cannot add elements to a plot.</p>
<p>In case we want to add elements to a plot, we need to instruct <code>plot</code>
not to reset, and then can add elements if we set <code>add = TRUE</code>, as shown
in figure <a href="plot.html#fig:figadd">10.4</a>.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" title="1"><span class="kw">plot</span>(nc[<span class="st">&quot;SID74&quot;</span>], <span class="dt">pal =</span> viridis<span class="op">::</span>viridis, <span class="dt">reset =</span> <span class="ot">FALSE</span>, <span class="dt">graticule =</span> <span class="ot">TRUE</span>, <span class="dt">axes =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb145-2" title="2"><span class="kw">plot</span>(<span class="kw">st_point</span>(<span class="kw">c</span>(<span class="op">-</span><span class="fl">81.498</span>,<span class="fl">36.434</span>)), <span class="dt">col =</span> <span class="st">&#39;red&#39;</span>, <span class="dt">pch =</span> <span class="dv">1</span>, <span class="dt">cex =</span> <span class="dv">4</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb145-3" title="3"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span>)) <span class="co"># manually reset the plotting region split-up</span></a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:figadd"></span>
<img src="sds_files/figure-html/figadd-1.png" alt="adding plot elements to a map with a key; graticule and axes" width="60%" />
<p class="caption">
Figure 10.4: adding plot elements to a map with a key; graticule and axes
</p>
</div>
</div>
<div id="plotting-graticules-and-axes" class="section level3">
<h3><span class="header-section-number">10.1.4</span> plotting graticules and axes</h3>
<p>A graticule (section <a href="plotting.html#graticule">9.5</a>) is added if <code>graticule = TRUE</code> is set; figure <a href="plot.html#fig:figadd">10.4</a> gives an example. Axes are by
default omitted: they take space, and often other map elements, such
as boundaries or coast lines, are sufficient for orientation. Axes
can be added with <code>axes = TRUE</code>. They are given in values of the
coordinate reference system of the data, unless a graticule is added,
in which case they correspond to the graticule values.</p>
</div>
<div id="plot.stars-defaults" class="section level3">
<h3><span class="header-section-number">10.1.5</span> <code>plot.stars</code> defaults</h3>
<p>The base plot method for <code>stars</code> objects follows a number of
parameters that were also discussed above for <code>plot.sf</code>. These are:
<code>key.pos</code>, <code>logz</code>, <code>axes</code>, <code>reset</code>, <code>key.width</code>, <code>key.length</code>
<code>nbreaks</code>, and <code>breaks</code>.</p>
<p>The default for <code>breaks</code> is <code>"quantile"</code>; along with the default
<code>join_zlim = TRUE</code> this results in quantile values taken from all
of the images shown in a composite plot to yeild color breaks. The
result of this is shown in figure <a href="raster.html#fig:firststars">6.1</a>, the default
<code>stars</code> plot for a multi-band raster. If <code>join_zlim</code> is <code>FALSE</code>,
color breaks are computed separately for each subplot, and a joint
legend is not possible, hence, no legend is drawn. For large datasets
with more than 10000 pixels, a (regular) sample of size 10000 is
taken to determine quantiles, rather than using the entire dataset.
The <code>col</code> argument provides the pallette used, and not a color
vector for each pixel; by default a linear grey scale is used.
<code>box_col</code> is the color used for the boxes around subplots.</p>
<p>With the default of <code>downsample = TRUE</code>, <code>plot.stars</code> does not plot
many more pixels than can be seen on the plotting device.</p>
<p>As shown in the left subfigure of <a href="raster.html#fig:starsrgb">6.2</a>, the <code>rgb</code>
parameter can be used to specify three bands for creating rgb
colors. <code>maxColorValue</code>, by default the maximum of all bands,
can be used to specify the maximum pixel values for scaling pixel
values into rgb components.</p>
<p>The effect of setting <code>text_values</code> and <code>interpolate</code> are shown in
figure <a href="plot.html#fig:starstext">10.5</a> showing a 10 x 10 cell raster. <code>text_values</code> prints cell values as text,
e.g. for numeric examples. <code>interpolate</code> interpolates <code>rgb</code> values, and
seems to limit its extent to the raster cell centres, rather than corners.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" title="1">tif =<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;tif/L7_ETMs.tif&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;stars&quot;</span>)</a>
<a class="sourceLine" id="cb146-2" title="2"><span class="kw">library</span>(stars)</a>
<a class="sourceLine" id="cb146-3" title="3">x =<span class="st"> </span><span class="kw">read_stars</span>(tif)</a>
<a class="sourceLine" id="cb146-4" title="4"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb146-5" title="5"><span class="kw">plot</span>(x[,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">1</span>], <span class="dt">text_values=</span><span class="ot">TRUE</span>, <span class="dt">key.pos =</span> <span class="ot">NULL</span>, <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">10</span>), </a>
<a class="sourceLine" id="cb146-6" title="6">	<span class="dt">reset =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb146-7" title="7"><span class="kw">plot</span>(x[,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dt">rgb=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">interpolate =</span> <span class="ot">TRUE</span>, <span class="dt">reset =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:starstext"></span>
<img src="sds_files/figure-html/starstext-1.png" alt="stars plots with text values (left) and interpolated rgb colors (right); both maps plot a 10 x 10 raster" width="60%" />
<p class="caption">
Figure 10.5: stars plots with text values (left) and interpolated rgb colors (right); both maps plot a 10 x 10 raster
</p>
</div>
<p>Some rasters cannot be plotted by R’s <code>image</code>, but have to be plotted
as features (polygons or points); examples are rotated, sheared
and curvilinear grids. Figure <a href="plot.html#fig:rastersheared">10.6</a> shows a sheared
grid, and illustrates <code>st_as_sf</code> for conversion to simple features,
<code>merge</code> for whether to merge polygons with identical values, and
<code>as_points</code> to plot raster cells as points.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb147-2" title="2">xs =<span class="st"> </span><span class="kw">adrop</span>(x[,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb147-3" title="3"><span class="kw">attr</span>(<span class="kw">attr</span>(xs, <span class="st">&quot;dimensions&quot;</span>), <span class="st">&quot;raster&quot;</span>)<span class="op">$</span>affine =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb147-4" title="4"><span class="kw">plot</span>(xs, <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">10</span>), <span class="dt">key.pos =</span> <span class="ot">NULL</span>, <span class="dt">reset =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb147-5" title="5"><span class="kw">plot</span>(<span class="kw">st_as_sf</span>(xs, <span class="dt">as_points =</span> <span class="ot">FALSE</span>, <span class="dt">merge =</span> <span class="ot">FALSE</span>), <span class="dt">pal =</span> viridis<span class="op">::</span>viridis, </a>
<a class="sourceLine" id="cb147-6" title="6">    <span class="dt">key.pos =</span> <span class="ot">NULL</span>, <span class="dt">reset =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb147-7" title="7"><span class="kw">plot</span>(<span class="kw">st_as_sf</span>(xs, <span class="dt">as_points =</span> <span class="ot">TRUE</span>, <span class="dt">merge =</span> <span class="ot">FALSE</span>), <span class="dt">key.pos =</span> <span class="ot">NULL</span>, </a>
<a class="sourceLine" id="cb147-8" title="8">    <span class="dt">pal =</span> viridis<span class="op">::</span>viridis, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">reset =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:rastersheared"></span>
<img src="sds_files/figure-html/rastersheared-1.png" alt="sheared rasters, plotted as simple features; left: with merged polygon features, middle: with seperate polygons, right: as point features" width="672" />
<p class="caption">
Figure 10.6: sheared rasters, plotted as simple features; left: with merged polygon features, middle: with seperate polygons, right: as point features
</p>
</div>
</div>
</div>
<div id="combining-base-plots" class="section level2">
<h2><span class="header-section-number">10.2</span> Combining base plots</h2>
<p>Figure <a href="plot.html#fig:rastersheared">10.6</a> is an exmaple of multiple plots of
<code>stars</code> and <code>sf</code> objects in one plot. They could be combined because
they lack the automatic legend key.</p>
<p>The explanation about the need for parameter <code>reset</code> and the examples
above with multiple subplots setting it to <code>FALSE</code> already show the
limitations of this approach: if we want a key next to each map,
we cannot easily combine maps in subplots, using <code>sf</code>‘s or <code>stars</code>’
<code>plot</code> methods. If we can do without the automatic legend, all
is fine.</p>
<p>A more flexible approach to combine maps and map elements into a
composite is using package <code>grid</code> as shown in the next section, or
<code>ggplot</code> facet plots (which also use <code>grid</code>) as will be shown in
chapter <a href="ggplot2.html#ggplot2">11</a> about <code>ggplot2</code>.</p>
</div>
<div id="grid-plots-and-viewports" class="section level2">
<h2><span class="header-section-number">10.3</span> Grid plots and viewports</h2>
<p>Package <code>grid</code>, one of the R base packages, takes a more structured
approach to building plots than base <code>plot</code> does. It allows the
creation of graphic objects (objects of class <code>grob</code>, or grobs)
that contain all the information for plotting, and the definition of
<em>viewports</em>, plotting subregions within which coordinate systems can
easily be redefined. Packages like <code>ggplot2</code> (chapter <a href="ggplot2.html#ggplot2">11</a>)
and <code>lattice</code> are built upon the logic provided by <code>grid</code>.</p>
<p>Package <code>sf</code> contains <code>st_as_grob</code> methods for all feature geometry
classes. Figure <a href="plot.html#fig:griddraw">10.7</a> shows a simple plot of all the
<code>nc</code> counties drawn using grid functions.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" title="1"><span class="kw">library</span>(grid)</a>
<a class="sourceLine" id="cb148-2" title="2"><span class="kw">system.file</span>(<span class="st">&quot;gpkg/nc.gpkg&quot;</span>, <span class="dt">package=</span><span class="st">&quot;sf&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>read_sf -&gt;<span class="st"> </span>nc</a>
<a class="sourceLine" id="cb148-3" title="3"><span class="kw">st_viewport</span>(nc) <span class="op">%&gt;%</span><span class="st"> </span>pushViewport</a>
<a class="sourceLine" id="cb148-4" title="4"><span class="kw">st_geometry</span>(nc) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">lapply</span>(st_as_grob) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">lapply</span>(grid.draw) -&gt;<span class="st"> </span>x</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:griddraw"></span>
<img src="sds_files/figure-html/griddraw-1.png" alt="simple plot created with grid functions" width="384" />
<p class="caption">
Figure 10.7: simple plot created with grid functions
</p>
</div>
<p>The <code>st_as_grob</code> methods are exported by <code>sf</code> and used by
<code>ggplot2::geom_sf</code> to convert geometries into plot-able objects;
this way, <code>ggplot2</code> needs no knowledge on how geometries are stored
in R objects.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="plotting.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ggplot2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/edzer/sdsr/edit/master/10-BasePlot.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["sds.pdf", "sds.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
