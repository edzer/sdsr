<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 10 ggplot2 | Spatial Data Science</title>
  <meta name="description" content="description_xx">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 10 ggplot2 | Spatial Data Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="description_xx" />
  <meta name="github-repo" content="edzer/sdsr" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 ggplot2 | Spatial Data Science" />
  
  <meta name="twitter:description" content="description_xx" />
  

<meta name="author" content="Edzer Pebesma, Roger Bivand">


<meta name="date" content="2019-04-30">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="plot.html">
<link rel="next" href="interactive-maps.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.1.17/leaflet-providers.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.2/leaflet-providers-plugin.js"></script>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<link href="libs/PopupTable-0.0.1/popup.css" rel="stylesheet" />


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Spatial Data Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Spatial Data</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Getting Started</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#a-first-map"><i class="fa fa-check"></i><b>1.1</b> A first map</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#reading"><i class="fa fa-check"></i><b>1.2</b> Reading and writing</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>1.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cs.html"><a href="cs.html"><i class="fa fa-check"></i><b>2</b> Coordinate systems</a><ul>
<li class="chapter" data-level="2.1" data-path="cs.html"><a href="cs.html#cartesian-and-geodetic-coordinates"><i class="fa fa-check"></i><b>2.1</b> Cartesian and geodetic coordinates</a></li>
<li class="chapter" data-level="2.2" data-path="cs.html"><a href="cs.html#ellipsoidal-coordinates"><i class="fa fa-check"></i><b>2.2</b> Ellipsoidal coordinates</a></li>
<li class="chapter" data-level="2.3" data-path="cs.html"><a href="cs.html#distances"><i class="fa fa-check"></i><b>2.3</b> Distances</a></li>
<li class="chapter" data-level="2.4" data-path="cs.html"><a href="cs.html#bounded-spaces"><i class="fa fa-check"></i><b>2.4</b> Bounded spaces</a></li>
<li class="chapter" data-level="2.5" data-path="cs.html"><a href="cs.html#time"><i class="fa fa-check"></i><b>2.5</b> Time</a></li>
<li class="chapter" data-level="2.6" data-path="cs.html"><a href="cs.html#exercises-1"><i class="fa fa-check"></i><b>2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="geometries.html"><a href="geometries.html"><i class="fa fa-check"></i><b>3</b> Geometries</a><ul>
<li class="chapter" data-level="3.1" data-path="geometries.html"><a href="geometries.html#simple-feature-geometry-types"><i class="fa fa-check"></i><b>3.1</b> Simple feature geometry types</a></li>
<li class="chapter" data-level="3.2" data-path="geometries.html"><a href="geometries.html#simple-features-in-sf"><i class="fa fa-check"></i><b>3.2</b> Simple features in <code>sf</code></a></li>
<li class="chapter" data-level="3.3" data-path="geometries.html"><a href="geometries.html#geomraster"><i class="fa fa-check"></i><b>3.3</b> Tesselations: coverages, rasters</a></li>
<li class="chapter" data-level="3.4" data-path="geometries.html"><a href="geometries.html#networks"><i class="fa fa-check"></i><b>3.4</b> Networks</a></li>
<li class="chapter" data-level="3.5" data-path="geometries.html"><a href="geometries.html#geometries-on-the-sphere"><i class="fa fa-check"></i><b>3.5</b> Geometries on the sphere</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="raster.html"><a href="raster.html"><i class="fa fa-check"></i><b>4</b> Raster and vector datacubes</a><ul>
<li class="chapter" data-level="4.1" data-path="raster.html"><a href="raster.html#package-stars"><i class="fa fa-check"></i><b>4.1</b> Package <code>stars</code></a></li>
<li class="chapter" data-level="4.2" data-path="raster.html"><a href="raster.html#raster-data"><i class="fa fa-check"></i><b>4.2</b> Raster data</a></li>
<li class="chapter" data-level="4.3" data-path="raster.html"><a href="raster.html#datacubes"><i class="fa fa-check"></i><b>4.3</b> Vector Datacubes</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="geommanip.html"><a href="geommanip.html"><i class="fa fa-check"></i><b>5</b> Manipulating Geometries</a><ul>
<li class="chapter" data-level="5.1" data-path="geommanip.html"><a href="geommanip.html#predicates"><i class="fa fa-check"></i><b>5.1</b> Predicates</a></li>
<li class="chapter" data-level="5.2" data-path="geommanip.html"><a href="geommanip.html#measures"><i class="fa fa-check"></i><b>5.2</b> Measures</a></li>
<li class="chapter" data-level="5.3" data-path="geommanip.html"><a href="geommanip.html#geometry-generating-functions"><i class="fa fa-check"></i><b>5.3</b> Geometry generating functions</a></li>
<li class="chapter" data-level="5.4" data-path="geommanip.html"><a href="geommanip.html#precision"><i class="fa fa-check"></i><b>5.4</b> Precision</a></li>
<li class="chapter" data-level="5.5" data-path="geommanip.html"><a href="geommanip.html#invalid"><i class="fa fa-check"></i><b>5.5</b> Generating invalid geometries</a></li>
<li class="chapter" data-level="5.6" data-path="geommanip.html"><a href="geommanip.html#longlat"><i class="fa fa-check"></i><b>5.6</b> Warnings for longitude/latitude geometries</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="featureattributes.html"><a href="featureattributes.html"><i class="fa fa-check"></i><b>6</b> Feature attributes</a><ul>
<li class="chapter" data-level="6.1" data-path="featureattributes.html"><a href="featureattributes.html#agr"><i class="fa fa-check"></i><b>6.1</b> Attribute-geometry relationships</a></li>
<li class="chapter" data-level="6.2" data-path="featureattributes.html"><a href="featureattributes.html#spatial-join"><i class="fa fa-check"></i><b>6.2</b> Spatial join</a></li>
<li class="chapter" data-level="6.3" data-path="featureattributes.html"><a href="featureattributes.html#aggregate-and-summarise"><i class="fa fa-check"></i><b>6.3</b> Aggregate and summarise</a></li>
<li class="chapter" data-level="6.4" data-path="featureattributes.html"><a href="featureattributes.html#intersections"><i class="fa fa-check"></i><b>6.4</b> Intersections</a></li>
<li class="chapter" data-level="6.5" data-path="featureattributes.html"><a href="featureattributes.html#area-weighted-interpolation"><i class="fa fa-check"></i><b>6.5</b> Area-weighted interpolation</a></li>
<li class="chapter" data-level="6.6" data-path="featureattributes.html"><a href="featureattributes.html#exercises-2"><i class="fa fa-check"></i><b>6.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="rs.html"><a href="rs.html"><i class="fa fa-check"></i><b>7</b> Reference Systems</a><ul>
<li class="chapter" data-level="7.1" data-path="rs.html"><a href="rs.html#units"><i class="fa fa-check"></i><b>7.1</b> Units of measurement</a></li>
<li class="chapter" data-level="7.2" data-path="rs.html"><a href="rs.html#temporal-reference-systems"><i class="fa fa-check"></i><b>7.2</b> Temporal Reference Systems</a></li>
<li class="chapter" data-level="7.3" data-path="rs.html"><a href="rs.html#crs"><i class="fa fa-check"></i><b>7.3</b> Coordinate Reference Systems</a></li>
</ul></li>
<li class="part"><span><b>II Maps</b></span></li>
<li class="chapter" data-level="8" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>8</b> Plotting spatial data</a><ul>
<li class="chapter" data-level="8.1" data-path="plotting.html"><a href="plotting.html#transform"><i class="fa fa-check"></i><b>8.1</b> Every plot is a projection</a></li>
<li class="chapter" data-level="8.2" data-path="plotting.html"><a href="plotting.html#plotting-points-lines-polygons-grid-cells"><i class="fa fa-check"></i><b>8.2</b> Plotting points, lines, polygons, grid cells</a></li>
<li class="chapter" data-level="8.3" data-path="plotting.html"><a href="plotting.html#class-intervals"><i class="fa fa-check"></i><b>8.3</b> Class intervals</a></li>
<li class="chapter" data-level="8.4" data-path="plotting.html"><a href="plotting.html#poles-and-datelines"><i class="fa fa-check"></i><b>8.4</b> Poles and datelines</a></li>
<li class="chapter" data-level="8.5" data-path="plotting.html"><a href="plotting.html#graticule"><i class="fa fa-check"></i><b>8.5</b> Graticules and other navigation aids</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="plot.html"><a href="plot.html"><i class="fa fa-check"></i><b>9</b> Base and grid plots</a><ul>
<li class="chapter" data-level="9.1" data-path="plot.html"><a href="plot.html#base-plots"><i class="fa fa-check"></i><b>9.1</b> Base plots</a></li>
<li class="chapter" data-level="9.2" data-path="plot.html"><a href="plot.html#combining-base-plots"><i class="fa fa-check"></i><b>9.2</b> Combining base plots</a></li>
<li class="chapter" data-level="9.3" data-path="plot.html"><a href="plot.html#grid-plots-and-viewports"><i class="fa fa-check"></i><b>9.3</b> Grid plots and viewports</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>10</b> ggplot2</a><ul>
<li class="chapter" data-level="10.1" data-path="ggplot2.html"><a href="ggplot2.html#geom_sf"><i class="fa fa-check"></i><b>10.1</b> <code>geom_sf</code></a></li>
<li class="chapter" data-level="10.2" data-path="ggplot2.html"><a href="ggplot2.html#geom_stars"><i class="fa fa-check"></i><b>10.2</b> <code>geom_stars</code></a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="interactive-maps.html"><a href="interactive-maps.html"><i class="fa fa-check"></i><b>11</b> Interactive Maps</a></li>
<li class="part"><span><b>III Spatial Analysis</b></span></li>
<li class="chapter" data-level="12" data-path="summarizing-geometries.html"><a href="summarizing-geometries.html"><i class="fa fa-check"></i><b>12</b> Summarizing Geometries</a></li>
<li class="chapter" data-level="13" data-path="pp.html"><a href="pp.html"><i class="fa fa-check"></i><b>13</b> Point Pattern Analysis</a></li>
<li class="chapter" data-level="14" data-path="manipulating-attributes-summarise-aggregate-union-sample.html"><a href="manipulating-attributes-summarise-aggregate-union-sample.html"><i class="fa fa-check"></i><b>14</b> Manipulating attributes: summarise, aggregate, union, sample</a></li>
<li class="chapter" data-level="15" data-path="up-and-downscaling.html"><a href="up-and-downscaling.html"><i class="fa fa-check"></i><b>15</b> Up- and Downscaling</a></li>
<li class="chapter" data-level="16" data-path="spatial-interpolation-and-geostatistics.html"><a href="spatial-interpolation-and-geostatistics.html"><i class="fa fa-check"></i><b>16</b> Spatial Interpolation and geostatistics</a><ul>
<li class="chapter" data-level="16.1" data-path="spatial-interpolation-and-geostatistics.html"><a href="spatial-interpolation-and-geostatistics.html#load-meuse-data"><i class="fa fa-check"></i><b>16.1</b> Load meuse data</a></li>
<li class="chapter" data-level="16.2" data-path="spatial-interpolation-and-geostatistics.html"><a href="spatial-interpolation-and-geostatistics.html#fit-variogram"><i class="fa fa-check"></i><b>16.2</b> fit variogram</a></li>
<li class="chapter" data-level="16.3" data-path="spatial-interpolation-and-geostatistics.html"><a href="spatial-interpolation-and-geostatistics.html#kriging-to-point-locations"><i class="fa fa-check"></i><b>16.3</b> kriging to point locations:</a></li>
<li class="chapter" data-level="16.4" data-path="spatial-interpolation-and-geostatistics.html"><a href="spatial-interpolation-and-geostatistics.html#kriging-to-stars-grid"><i class="fa fa-check"></i><b>16.4</b> kriging to stars grid:</a></li>
<li class="chapter" data-level="16.5" data-path="spatial-interpolation-and-geostatistics.html"><a href="spatial-interpolation-and-geostatistics.html#spatio-temporal"><i class="fa fa-check"></i><b>16.5</b> Spatio-temporal</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="area-data-and-spatial-autcorrelation.html"><a href="area-data-and-spatial-autcorrelation.html"><i class="fa fa-check"></i><b>17</b> Area Data and Spatial Autcorrelation</a><ul>
<li class="chapter" data-level="17.1" data-path="area-data-and-spatial-autcorrelation.html"><a href="area-data-and-spatial-autcorrelation.html#spatial-autocorrelation"><i class="fa fa-check"></i><b>17.1</b> Spatial autocorrelation</a></li>
<li class="chapter" data-level="17.2" data-path="area-data-and-spatial-autcorrelation.html"><a href="area-data-and-spatial-autcorrelation.html#spatial-weights-matrices"><i class="fa fa-check"></i><b>17.2</b> Spatial weights matrices</a></li>
<li class="chapter" data-level="17.3" data-path="area-data-and-spatial-autcorrelation.html"><a href="area-data-and-spatial-autcorrelation.html#measures-of-spatial-autocorrelation"><i class="fa fa-check"></i><b>17.3</b> Measures of spatial autocorrelation</a></li>
<li class="chapter" data-level="17.4" data-path="area-data-and-spatial-autcorrelation.html"><a href="area-data-and-spatial-autcorrelation.html#spatial-heterogeneity"><i class="fa fa-check"></i><b>17.4</b> Spatial heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="spatial-regression.html"><a href="spatial-regression.html"><i class="fa fa-check"></i><b>18</b> Spatial Regression</a><ul>
<li class="chapter" data-level="18.1" data-path="spatial-regression.html"><a href="spatial-regression.html#spatial-regression-without-spatial-weights"><i class="fa fa-check"></i><b>18.1</b> Spatial regression without spatial weights</a></li>
<li class="chapter" data-level="18.2" data-path="spatial-regression.html"><a href="spatial-regression.html#spatial-regression-with-spatial-weights"><i class="fa fa-check"></i><b>18.2</b> Spatial regression with spatial weights</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="movement-data.html"><a href="movement-data.html"><i class="fa fa-check"></i><b>19</b> Movement data</a></li>
<li class="chapter" data-level="20" data-path="statistical-modelling-of-spatiotemporal-data.html"><a href="statistical-modelling-of-spatiotemporal-data.html"><i class="fa fa-check"></i><b>20</b> Statistical modelling of spatiotemporal data</a></li>
<li class="chapter" data-level="21" data-path="sp-and-raster.html"><a href="sp-and-raster.html"><i class="fa fa-check"></i><b>21</b> sp and raster</a><ul>
<li class="chapter" data-level="21.1" data-path="sp-and-raster.html"><a href="sp-and-raster.html#links-and-differences-between-sf-and-sp"><i class="fa fa-check"></i><b>21.1</b> links and differences between sf and sp</a></li>
<li class="chapter" data-level="21.2" data-path="sp-and-raster.html"><a href="sp-and-raster.html#migration-packages"><i class="fa fa-check"></i><b>21.2</b> migration packages</a></li>
<li class="chapter" data-level="21.3" data-path="sp-and-raster.html"><a href="sp-and-raster.html#raster-stars-and-sf"><i class="fa fa-check"></i><b>21.3</b> raster, stars and sf</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-data-structures.html"><a href="r-data-structures.html"><i class="fa fa-check"></i>R data structures</a><ul>
<li class="chapter" data-level="21.4" data-path="r-data-structures.html"><a href="r-data-structures.html#homogeneous-vectors"><i class="fa fa-check"></i><b>21.4</b> Homogeneous vectors</a></li>
<li class="chapter" data-level="21.5" data-path="r-data-structures.html"><a href="r-data-structures.html#heterogeneous-vectors-list"><i class="fa fa-check"></i><b>21.5</b> Heterogeneous vectors: list</a></li>
<li class="chapter" data-level="21.6" data-path="r-data-structures.html"><a href="r-data-structures.html#attributes"><i class="fa fa-check"></i><b>21.6</b> Attributes</a></li>
<li class="chapter" data-level="21.7" data-path="r-data-structures.html"><a href="r-data-structures.html#various-names-attributes"><i class="fa fa-check"></i><b>21.7</b> various names attributes</a></li>
<li class="chapter" data-level="21.8" data-path="r-data-structures.html"><a href="r-data-structures.html#using-structure"><i class="fa fa-check"></i><b>21.8</b> using structure</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ggplot2" class="section level1">
<h1><span class="header-section-number">Chapter 10</span> ggplot2</h1>
<p>Function <code>ggplot</code> from package <code>ggplot2</code> <span class="citation">(Wickham <a href="#ref-wickham2016ggplot2">2016</a>)</span>
provides a high-level interface to creating graphs, essentially
by composing all their ingredients and constraints in a
single expression. It implements the “grammar for graphics” by
<span class="citation">Wilkinson (<a href="#ref-wilkinson2006grammar">2006</a>)</span>, and is the plotting package of choice in the
<code>tidyverse</code>.</p>
<p>Before <code>ggplot</code> 3.0.0 came out, the approach to plotting spatial
data was to <em>fortify</em> it, meaning encode all the geometries as atomic
vectors in a <code>data.frame</code>, keeping an <code>ID</code> column to register which
coordinate belonged to which geometry, and repeating all non-geometry
attributes for each geometry <em>coordinate</em>. This worked reasonably
well for points and lines, but not very well for polygons with holes.</p>
<p>Since <code>ggplot</code> 3.0.0 and package <code>sf</code>, this runs much smoother;
<code>ggplot</code> has received a <code>geom_sf</code> function that could take an <code>sf</code>
object and calls <code>st_as_grob</code> on each feature geometry to get an
object that can directly be added to the plot. In addition to that,
it takes care of automated datum transformations or projections
if different objects have differing coordinate reference systems,
and adds by default a graticule and degree axis tic labels.</p>
<p><span class="citation">Moreno and Basille (<a href="#ref-moreno1">n.d.</a>)</span>, <span class="citation">Moreno and Basille (<a href="#ref-moreno2">n.d.</a>)</span> and <span class="citation">Moreno and Basille (<a href="#ref-moreno3">n.d.</a>)</span> published three guest blogs on
r-spatial.org explaining the capabilities of ggplot for making
beautiful maps with <code>sf</code> and <code>ggplot2</code>.</p>
<div id="geom_sf" class="section level2">
<h2><span class="header-section-number">10.1</span> <code>geom_sf</code></h2>
<p>We will introduce the affordances of <code>geom_sf</code> here step by step.
We use a projected version of <code>nc</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(sf)
<span class="kw">system.file</span>(<span class="st">&quot;gpkg/nc.gpkg&quot;</span>, <span class="dt">package=</span><span class="st">&quot;sf&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">read_sf</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">st_transform</span>(<span class="dv">32119</span>) -&gt;<span class="st"> </span>nc<span class="fl">.32119</span></code></pre>
<p>and create a first <code>ggplot</code> by</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> nc<span class="fl">.32119</span>) </code></pre>
<p><img src="sds_files/figure-html/unnamed-chunk-192-1.png" width="672" style="display: block; margin: auto;" />
It is attractive to think that</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(nc<span class="fl">.32119</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_sf</span>()</code></pre>
<p>would also work, but it doesn’t – it only works if the geometry
column is named <code>geometry</code>, which is not always the case (<code>sf</code>
objects may have more than one geometry column).</p>
<p>If we want to get rid of the axis tics and grid lines, we could use</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> nc<span class="fl">.32119</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_line</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>))</code></pre>
<p><img src="sds_files/figure-html/unnamed-chunk-194-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>A first ggplot2 plot with polygons colored by attributes
(as in figure <a href="intro.html#fig:firstggplot">1.2</a>) is created by</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> nc<span class="fl">.32119</span>) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">fill =</span> BIR74) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">20</span>))</code></pre>
<p><img src="sds_files/figure-html/unnamed-chunk-195-1.png" width="672" style="display: block; margin: auto;" /></p>
<div id="facet-plots" class="section level3">
<h3><span class="header-section-number">10.1.1</span> facet plots</h3>
<p>Facet plots are a powerful means to compare maps, because they
keep all the plotting parameters constant (spatial extent, scale,
color breaks). One would perhaps wish that it were possible to
directly plot multiple attribute columns over facet maps. For this,
we first have to reorganise the data such that the target variable is
a single column, another column indicates the facet, and geometries
are repeated accordingly. For this, <code>tidyr::gather</code> can be used; an
example is given in figure <a href="intro.html#fig:firstgather">1.3</a>.</p>
</div>
<div id="multiple-geometries-in-a-single-map" class="section level3">
<h3><span class="header-section-number">10.1.2</span> multiple geometries in a single map</h3>
<p>Multiple geometries with <code>geom_sf</code> can be created by adding consecutive
<code>geom_sf</code> geometries; we can add for instance the county centroids to
a plot by</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> nc<span class="fl">.32119</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> <span class="kw">st_centroid</span>(nc<span class="fl">.32119</span>))
<span class="co">#&gt; Warning in st_centroid.sf(nc.32119): st_centroid assumes attributes are</span>
<span class="co">#&gt; constant over geometries of x</span></code></pre>
<p><img src="sds_files/figure-html/unnamed-chunk-196-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>When subsequent <code>sf</code> objects have a different coordinate reference
system from the first object, <code>geom_sf</code> will transform them to the
reference system of the first object.</p>
</div>
<div id="fine-tuning" class="section level3">
<h3><span class="header-section-number">10.1.3</span> Fine tuning</h3>
<p>In case <code>sf</code> objects have multiple geometry list-columns, the
“active” list column is selected by default. This can be overriden
by supplying another column name in <code>aes(geometry = my_column)</code> `</p>
<p>To add labels to geometries, one can use <code>geom_sf_label</code>. From the examples of <code>geom_sf</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">nc &lt;-<span class="st"> </span>sf<span class="op">::</span><span class="kw">st_read</span>(<span class="kw">system.file</span>(<span class="st">&quot;gpkg/nc.gpkg&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;sf&quot;</span>), <span class="dt">quiet =</span> <span class="ot">TRUE</span>)
nc_<span class="dv">3857</span> &lt;-<span class="st"> </span>sf<span class="op">::</span><span class="kw">st_transform</span>(nc, <span class="st">&quot;+init=epsg:3857&quot;</span>)
<span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> nc_<span class="dv">3857</span>[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, ], <span class="kw">aes</span>(<span class="dt">fill =</span> AREA)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_sf_label</span>(<span class="dt">data =</span> nc_<span class="dv">3857</span>[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, ], <span class="kw">aes</span>(<span class="dt">label =</span> NAME))</code></pre>
<p><img src="sds_files/figure-html/unnamed-chunk-197-1.png" width="672" style="display: block; margin: auto;" />
<code>geom_sf_text</code> can be used to add simple text annotations without decoration.</p>
<p>Graticules are drawn by default. Since they are different for
every projection, it is hard to anticipate how strongly they will
be curved. <code>geom_sf</code> takes a parameter <code>ndiscr</code>, by default set to
100, which can be increased when graticulas show up unexpectedly
as non-smooth lines.</p>
<p><code>label_graticules</code> can be used to control which graticules are
labeled. In addition, <code>label_axes</code> controls on which axes particular
graticules will be labeled.</p>
</div>
</div>
<div id="geom_stars" class="section level2">
<h2><span class="header-section-number">10.2</span> <code>geom_stars</code></h2>
<p>Package <code>stars</code> comes with a <code>geom_stars</code> function that is much
more limited in scope than <code>geom_sf</code>. In essence, it creates a call
to</p>
<ul>
<li><code>geom_raster</code> in case of raster data with a regular grid,</li>
<li>to <code>geom_tile</code> for other raster data, or</li>
<li>to <code>geom_sf</code> if the <code>stars</code> object has a simple feature geometry dimension rather than raster dimensions, or has a curvilinear raster</li>
</ul>
<p><code>geom_raster</code> also creates the mapping of dimension names to x
and y-coordinates and set the first attribute name as the <code>fill</code>
variable. This means that the aspect ratio still needs to be
controlled (<code>coord_equal()</code>) and that a <code>facet_wrap</code> is needed
to display multiple rasters. An example is shown in figure
<a href="ggplot2.html#fig:geomraster">10.1</a>.</p>

<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(stars)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(viridis)
<span class="co">#&gt; Loading required package: viridisLite</span>
<span class="kw">system.file</span>(<span class="st">&quot;tif/L7_ETMs.tif&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;stars&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">read_stars</span>() -&gt;<span class="st"> </span>x
<span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_stars</span>(<span class="dt">data =</span> x) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>band) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">scale_fill_viridis</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_x_discrete</span>(<span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</code></pre>
<div class="figure" style="text-align: center"><span id="fig:geomraster"></span>
<img src="sds_files/figure-html/geomraster-1.png" alt="example of geom_stars" width="672" />
<p class="caption">
Figure 10.1: example of <code>geom_stars</code>
</p>
</div>
<p><code>geom_stars</code> has a parameter, <code>downsample</code>, which can be used to downsample
particular dimensions. Here we downsample a 90m x 90m raster to a 900m x 900m
raster:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_stars</span>(<span class="dt">data =</span> x, <span class="dt">downsample =</span> <span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>band) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">scale_fill_viridis</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_x_discrete</span>(<span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))<span class="op">+</span>
<span class="st">    </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</code></pre>
<p><img src="sds_files/figure-html/unnamed-chunk-198-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(spacetime)
<span class="kw">data</span>(air) <span class="co"># this loads several datasets in .GlobalEnv</span>
d =<span class="st"> </span><span class="kw">st_dimensions</span>(<span class="dt">station =</span> <span class="kw">st_as_sfc</span>(stations), <span class="dt">time =</span> dates)
aq =<span class="st"> </span><span class="kw">st_as_stars</span>(<span class="kw">list</span>(<span class="dt">PM10 =</span> air), <span class="dt">dimensions =</span> d)
<span class="co"># ggplot() + geom_stars(data = aq[,,3000])</span>
aq.sf =<span class="st"> </span><span class="kw">st_as_sf</span>(aq[,,<span class="dv">3000</span>], <span class="dt">long=</span><span class="ot">TRUE</span>)
<span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">   </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> <span class="kw">st_as_sf</span>(DE_NUTS1)) <span class="op">+</span><span class="st"> </span>
<span class="st">   </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> aq.sf, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">col =</span> PM10)) <span class="op">+</span><span class="st"> </span>
<span class="st">   </span><span class="kw">ggtitle</span>(aq.sf<span class="op">$</span>time[<span class="dv">1</span>])</code></pre>
<p><img src="sds_files/figure-html/unnamed-chunk-199-1.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-wickham2016ggplot2">
<p>Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer.</p>
</div>
<div id="ref-wilkinson2006grammar">
<p>Wilkinson, Leland. 2006. <em>The Grammar of Graphics</em>. Springer Science &amp; Business Media.</p>
</div>
<div id="ref-moreno1">
<p>Moreno, Mel, and Mathieu Basille. n.d. <em>Drawing Beautiful Maps Programmatically with R, Sf and Ggplot2 - Part 1: Basics</em>. r-spatial.org. <a href="https://www.r-spatial.org/r/2018/10/25/ggplot2-sf.html" class="uri">https://www.r-spatial.org/r/2018/10/25/ggplot2-sf.html</a>.</p>
</div>
<div id="ref-moreno2">
<p>Moreno, Mel, and Mathieu Basille. n.d. <em>Drawing Beautiful Maps Programmatically with R, Sf and Ggplot2 — Part 2: Layers</em>. r-spatial.org. <a href=" https://www.r-spatial.org/r/2018/10/25/ggplot2-sf-2.html">https://www.r-spatial.org/r/2018/10/25/ggplot2-sf-2.html</a>.</p>
</div>
<div id="ref-moreno3">
<p>Moreno, Mel, and Mathieu Basille. n.d. <em>Drawing Beautiful Maps Programmatically with R, Sf and Ggplot2 — Part 3: Layouts</em>. https://www.r-spatial.org. <a href=" https://www.r-spatial.org/r/2018/10/25/ggplot2-sf-3.html">https://www.r-spatial.org/r/2018/10/25/ggplot2-sf-3.html</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="plot.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="interactive-maps.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/edzer/sdsr/edit/master/10-Ggplot2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["sds.pdf", "sds.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
